<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Imágenes Amigas de Nuestro Entorno</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 2em;
      text-align: center;
      overflow-x: hidden;
    }
    h1 {
      color: #333;
    }
    .galeria {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1em;
      margin-top: 2em;
    }
    .galeria img {
      width: 220px;
      border-radius: 6px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .galeria img:hover {
      transform: scale(1.05);
    }

    .visor {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 9999;
      padding: 1em;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .visor.visible {
      display: flex;
      opacity: 1;
    }
    .visor img {
      max-width: 90%;
      max-height: 80vh;
      border-radius: 6px;
      box-shadow: 0 0 20px rgba(0,0,0,0.8);
      transition: transform 0.3s ease;
    }
    .descripcion {
      color: #fff;
      margin-top: 1em;
      font-size: 1.1em;
      max-width: 90%;
      max-height: 150px;
      overflow-y: auto;
      white-space: pre-line;
      background: rgba(0,0,0,0.4);
      padding: 0.8em 1em;
      border-radius: 6px;
      box-sizing: border-box;
    }
    .cerrar {
      position: absolute;
      top: 1em;
      right: 1em;
      font-size: 2.5em;
      color: #fff;
      cursor: pointer;
      user-select: none;
    }
    .flechas {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
      padding: 0 1em;
      z-index: 10000;
    }
    .flechas span {
      font-size: 3em;
      color: #fff;
      cursor: pointer;
      user-select: none;
      width: 2em;
      text-align: center;
      user-select: none;
      transition: color 0.2s;
    }
    .flechas span:hover {
      color: #ffcc00;
    }
    .descripcion::-webkit-scrollbar {
      width: 8px;
    }
    .descripcion::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
    }

    @media (max-width: 768px) {
      .visor img {
        max-height: 60vh;
      }

      .descripcion {
        max-height: 30vh;
        font-size: 1em;
      }

      .flechas span {
        font-size: 2.5em;
      }

      .cerrar {
        font-size: 2em;
      }
    }
  </style>
</head>
<body>

  <h1>Imágenes Amigas de Nuestro Entorno</h1>

  <div class="galeria">
    <img
      loading="lazy"
      src="Foto_001_Expacionavalmoral.jpg"
      alt="Exposición en Navalmoral de la Mata"
      data-desc="23 de mayo de 2021. Expacionavalmoral ha sido protagonista estos días en la actualidad morala, entre otras cosas, por el aterrizaje de emergencia de una avioneta en una de sus avenidas. Buen momento para incluir esta fotografía, que nos ha hecho llegar Yoguifly’s, en “Imágenes Amigas de nuestro entorno”.">

    <img
      loading="lazy"
      src="Foto_002_trafico.jpg"
      alt="Tráfico en la peatonal"
      data-desc="15 de abril de 2022. Así va el tráfico en la peatonal de Navalmoral de la Mata.">

    <img
      loading="lazy"
      src="Foto_003_orquidea.jpg"
      alt="Orquídea silvestre"
      data-desc="9 de abril de 2021. Apoyada en una orquídea (ophrys scolopax), esta abeja (apis mellifera) parece estar reflexionando sobre su existencia, esperando a su pareja o averigua tú…, pero aquí donde la vemos obtuvo la mención especial “Premio al mejor participante local” con el título Relamiendo_scolopax en el concurso Ochydarium 2019, y es la protagonista en esta ocasión de “Imágenes amigas de nuestro entorno”. La escena fue captada por Fernando Sánchez Castilla en el Sierro de Almaraz.">

    <img
      loading="lazy"
      src="Foto_004_mirador_Las_Ollas.jpg"
      alt="Mirador Las Hollas"
      data-desc="3 de abril de 2021. El mirador en el Paraje Las Ollas, en Cuacos de Yuste, protagonista este mes en “Imágenes amigas de nuestro entorno”. | PdE">

    <img
      loading="lazy"
      src="Foto_005_fuente-la-Teja.jpg"
      alt="Fuente La Teja"
      data-desc="28 de marzo de 2021. Ya se deja notar la primavera en Navalmoral, con su paleta de colores en la fuente de la Teja y sus alrededores. Fuente la Teja en Navalmoral de la Mata. | Yoguifly’s | PdE">
  </div>

  <div
    class="visor"
    id="visor"
    role="dialog"
    aria-modal="true"
    aria-labelledby="descripcion"
  >
    <span
      class="cerrar"
      role="button"
      aria-label="Cerrar visor"
      tabindex="0"
      onclick="cerrarVisor()"
      onkeypress="if(event.key==='Enter') cerrarVisor()"
    >×</span>

    <div class="flechas">
      <span role="button" aria-label="Imagen anterior" tabindex="0" onclick="cambiarImagen(-1)" onkeypress="if(event.key==='Enter') cambiarImagen(-1)">‹</span>
      <span role="button" aria-label="Imagen siguiente" tabindex="0" onclick="cambiarImagen(1)" onkeypress="if(event.key==='Enter') cambiarImagen(1)">›</span>
    </div>

    <img id="imagenGrande" src="" alt="" loading="eager" />
    <div class="descripcion" id="descripcion"></div>
  </div>

  <script>
    const imagenes = document.querySelectorAll('.galeria img');
    const visor = document.getElementById('visor');
    const imagenGrande = document.getElementById('imagenGrande');
    const descripcion = document.getElementById('descripcion');
    let indiceActual = 0;

    function bloquearScroll(bloquear) {
      document.body.style.overflow = bloquear ? 'hidden' : '';
    }

    imagenes.forEach((img, i) => {
      img.addEventListener('click', () => {
        indiceActual = i;
        mostrarImagen();
        visor.classList.add('visible');
        bloquearScroll(true);
        precargarVecinas();
      });
    });

    function mostrarImagen() {
      const img = imagenes[indiceActual];
      imagenGrande.src = img.src;
      imagenGrande.alt = img.alt;
      descripcion.textContent = img.dataset.desc;
    }

    function cerrarVisor() {
      visor.classList.remove('visible');
      bloquearScroll(false);
    }

    function cambiarImagen(direccion) {
      indiceActual = (indiceActual + direccion + imagenes.length) % imagenes.length;
      mostrarImagen();
      precargarVecinas();
    }

    function precargarVecinas() {
      const prev = imagenes[(indiceActual - 1 + imagenes.length) % imagenes.length].src;
      const next = imagenes[(indiceActual + 1) % imagenes.length].src;
      new Image().src = prev;
      new Image().src = next;
    }

    document.addEventListener('keydown', e => {
      if (visor.classList.contains('visible')) {
        if (e.key === 'ArrowRight') cambiarImagen(1);
        if (e.key === 'ArrowLeft') cambiarImagen(-1);
        if (e.key === 'Escape') cerrarVisor();
      }
    });

    // Soporte clic y toque fuera del visor
    function esElementoInterno(elemento) {
      return (
        elemento === imagenGrande ||
        elemento === descripcion ||
        elemento.closest('.flechas') ||
        elemento.classList.contains('cerrar')
      );
    }

    ['click', 'touchstart'].forEach(evt =>
      visor.addEventListener(evt, e => {
        if (!esElementoInterno(e.target)) {
          cerrarVisor();
        }
      })
    );
  </script>

</body>
</html>
